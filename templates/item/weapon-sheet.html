<form class="{{cssClass}} flexcol" autocomplete="off">

  <header class="sheet-header flexrow" style="gap:12px; align-items:center;">
    <img class="profile-img" src="{{item.img}}" data-edit="img" width="64" height="64"/>
    <div class="flexcol" style="flex:1;">
      <h1 style="margin:0;">
        <input name="name" type="text" value="{{item.name}}" placeholder="Weapon Name"/>
      </h1>
      <div style="opacity:0.8; font-size:12px;">Weapon</div>
    </div>
  </header>

  <section class="sheet-body flexcol" style="flex:1; min-height:520px;">

    <div class="flexrow" style="gap:12px; margin-top:8px;">
      <div class="flexcol" style="flex:1;">
        <h3>Economy</h3>
        <div class="flexrow" style="gap:8px; align-items:center;">
          <label style="flex:1;">Restriction</label>
          <input type="number" name="system.restriction" value="{{system.restriction}}" style="width:90px;">
        </div>
        <div class="flexrow" style="gap:8px; align-items:center;">
          <label style="flex:1;">Cost</label>
          <input type="number" name="system.cost" value="{{system.cost}}" style="width:90px;">
        </div>
        <div class="flexrow" style="gap:8px; align-items:center;">
          <label style="flex:1;">Reliability</label>
          <input type="number" name="system.stats.reliability" value="{{system.stats.reliability}}" style="width:90px;">
        </div>
      </div>

      <div class="flexcol" style="flex:1;">
        <h3>Stats</h3>
        
        <div class="flexrow" style="gap:8px; align-items:center;">
          <label style="flex:1;">Weapon Type</label>
          <select name="system.weaponType" style="width:100%;">
            <option value="ranged" {{#if (eq system.weaponType "ranged")}}selected{{/if}}>Ranged</option>
            <option value="melee"  {{#if (eq system.weaponType "melee")}}selected{{/if}}>Melee</option>
          </select>
        </div>

        <div class="flexrow" style="gap:8px; align-items:center;">
          {{#if (eq system.weaponType "ranged")}}
            <label style="flex:1;">Range</label>
            <select name="system.stats.range" style="width:100%;">
              <option value="Reach"   {{#if (eq system.stats.range "Reach")}}selected{{/if}}>Reach</option>
              <option value="Close"   {{#if (eq system.stats.range "Close")}}selected{{/if}}>Close</option>
              <option value="Medium"  {{#if (eq system.stats.range "Medium")}}selected{{/if}}>Medium</option>
              <option value="Long"    {{#if (eq system.stats.range "Long")}}selected{{/if}}>Long</option>
              <option value="Extreme" {{#if (eq system.stats.range "Extreme")}}selected{{/if}}>Extreme</option>
            </select>
          {{/if}}
        </div>
        <div class="flexrow" style="gap:8px; align-items:center;">
          {{#if (eq system.weaponType "ranged")}}
            <label style="flex:1;">Firing Mode</label>
            <select name="system.stats.mode" style="width:100%;">
              <option value="Munition"        {{#if (eq system.stats.mode "Munition")}}selected{{/if}}>Munition</option>
              <option value="Semi-Automatic"  {{#if (eq system.stats.mode "Semi-Automatic")}}selected{{/if}}>Semi-Automatic</option>
              <option value="Burst"           {{#if (eq system.stats.mode "Burst")}}selected{{/if}}>Burst</option>
              <option value="Automatic"       {{#if (eq system.stats.mode "Automatic")}}selected{{/if}}>Automatic</option>
            </select>
          {{/if}}
        </div>
        <div class="flexrow" style="gap:8px; align-items:center;">
          <label style="flex:1;">Size</label>
          <select name="system.stats.size" style="width:100%;">
    <option value="One-Handed" {{#if (eq system.stats.size "One-Handed")}}selected{{/if}}>One-Handed</option>
    <option value="Two-Handed" {{#if (eq system.stats.size "Two-Handed")}}selected{{/if}}>Two-Handed</option>
    <option value="Unbalanced" {{#if (eq system.stats.size "Unbalanced")}}selected{{/if}}>Unbalanced</option>
    <option value="Unwieldy" {{#if (eq system.stats.size "Unwieldy")}}selected{{/if}}>Unwieldy</option>
  </select>
        </div>
        <div class="flexrow" style="gap:8px; align-items:center;">
  <label style="flex:1;">Encumbrance</label>
  <input type="number" name="system.stats.enc" value="{{system.stats.enc}}">
</div>
      </div>
    </div>

    <h3 style="margin-top:12px;">Damage</h3>
    <div class="flexrow" style="gap:12px; align-items:center;">
      <label style="display:flex; gap:6px; align-items:center;">
        <span>Base</span>
        <input type="number" name="system.damage.base" value="{{system.damage.base}}" style="width:90px;">
      </label>
      <label style="display:flex; gap:6px; align-items:center;">
        <span>{{{dsify "DSD"}}}</span>
        <input type="number" name="system.damage.dsy" value="{{system.damage.dsy}}" style="width:90px;">
      </label>
      <label style="display:flex; gap:6px; align-items:center;">
        <span>Flat Bonus</span>
        <input type="number" name="system.damage.flatBonus" value="{{system.damage.flatBonus}}" style="width:110px;">
      </label>
    </div>

    <h3 style="margin-top:12px; display:flex; justify-content:space-between; align-items:center;">
      <span>Weapon Qualities</span>
      <small style="opacity:0.8;">Drop a Quality item here</small>
    </h3>

    <div class="mcde-quality-dropzone"
         style="min-height:40px; padding:8px; border:1px dashed rgba(120,0,0,0.35); border-radius:6px;">
      {{#if system.qualities.length}}
        <div style="display:flex; flex-wrap:wrap; gap:6px;">
          {{#each system.qualities as |q i|}}
            <span class="mcde-quality-tag" data-tooltip="{{q.description}}"
                  style="display:inline-flex; gap:6px; align-items:center; padding:2px 8px; border:1px solid rgba(120,0,0,0.4); border-radius:999px; font-size:12px;">
              {{q.name}}
              <a class="mcde-quality-remove" data-index="{{i}}" title="Remove"><i class="fas fa-times"></i></a>
            </span>
          {{/each}}
        </div>
      {{else}}
        <div style="opacity:0.7; font-size:12px;">No qualities yet.</div>
      {{/if}}
    </div>

<h3 style="margin-top:12px;">Description</h3>
<div style="min-height:220px;">
  {{editor enriched.description target="system.description" button=true owner=owner editable=editable engine="prosemirror"}}
</div>

  </section>
</form>
